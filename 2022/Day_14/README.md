Used a couple of inline table functions to make it more managable.<BR>
Initially tried to do with geometric types, but event the 1st solution took forever.<BR>
After a lot of tuning I got part 1 to run in ~35 seconds and part 2 to run in ~1:10 hours.

