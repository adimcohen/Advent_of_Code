drop table if exists Numbers

;with rec as
	(select 1 Num
	union all
	select Num + 1
	from rec
	where Num < 32767
	)
select Num
into Numbers
from rec
option (maxrecursion 32767)
create unique clustered index IX_Numbers on Numbers(Num)
GO
create or alter function fn_AOC_2022_Day13_GetItemInfo(@Item varchar(max)) returns table
as
	return select ItemType, IsList, ItemCount
				from (select case when @Item like '%]%]' then null
								when @Item like '%]' then 3
								else 1
							end ItemType) it
					cross apply (select iif(ItemType = 3 or ItemType is null, 1, 0) IsList) il
					outer apply (select count(*) ItemCount
									from openjson(@Item, '$')
									where ItemType = 3
										or ItemType is null) ic
GO
create or alter function fn_AOC_2022_Day13_CompareValues(@Value1 int,
														@Value2 int
														) returns table
as
	return select case when @Value1 < @Value2 or @Value1 is null
							then 1
						when @Value2 < @Value1 or @Value2 is null
							then -1
						else 0
					end IsInOrder
GO
create or alter function fn_AOC_2022_Day13_MakeList(@Item varchar(max),
													@IsList bit
														) returns table
as
	return select iif(@IsList = 1,  @Item, '[' + @Item + ']') List,
				iif(@IsList = 0, 1, null) NewtemCount
GO
create or alter function fn_AOC_2022_Day13_DecideInOrder(@FirstItemIDInOrder int,
														@FirstItemIDOutOfOrder int) returns table
as
	return select case when @FirstItemIDInOrder < @FirstItemIDOutOfOrder or @FirstItemIDOutOfOrder is null and @FirstItemIDInOrder is not null
							then 1
						when @FirstItemIDOutOfOrder < @FirstItemIDInOrder or @FirstItemIDInOrder is null and @FirstItemIDOutOfOrder is not null
							then -1
						else 0
					end IsInOrder
GO
create or alter function fn_AOC_2022_Day13_CompareLists(@Item1 varchar(max),
														@IsList1 bit,
														@Item2 varchar(max),
														@IsList2 bit,
														@MaxItemCount int) returns table
as
return with i as
			(select min(iif(IsInOrder = 1, ItemID, null)) FirstItemIDInOrder,
					min(iif(IsInOrder = -1, ItemID, null)) FirstItemIDOutOfOrder
				from fn_AOC_2022_Day13_MakeList(@Item1, @IsList1) l1
					cross join fn_AOC_2022_Day13_MakeList(@Item2, @IsList2) l2
					cross apply (select coalesce(nullif(@MaxItemCount, 0), l1.NewtemCount, l2.NewtemCount) NewMaxItemCount) n
					left join Numbers on Num <= NewMaxItemCount
					cross apply (select isnull(Num, 0) - 1 ItemID) i
					outer apply (select *
									from openjson(l1.List, '$')
									where [key] = ItemID
								) p1
					outer apply (select *
									from openjson(l2.List, '$')
									where [key] = ItemID
								) p2
					cross apply (select iif(l1.List = '[]', -1, cast(p1.[value] as int)) Item1,
									iif(l2.List = '[]', -1, cast(p2.[value] as int)) Item2
									) it
					cross apply fn_AOC_2022_Day13_CompareValues(Item1, Item2)
			)
		select IsInOrder
		from i
			cross apply fn_AOC_2022_Day13_DecideInOrder(FirstItemIDInOrder, FirstItemIDOutOfOrder)
GO
create or alter function fn_AOC_2022_Day13_GetIsInOrder(@Item1 varchar(max),
														@IsList1 bit,
														@Item2 varchar(max),
														@IsList2 bit,
														@MaxItemCount int) returns table
as
	return select case when @IsList1 = 0 and @IsList2 = 0
							then (select IsInOrder from fn_AOC_2022_Day13_CompareValues(cast(@Item1 as int), cast(@Item2 as int)))
						when @IsList1 = 1 or @IsList2 = 1
							then (select IsInOrder from fn_AOC_2022_Day13_CompareLists(@Item1, @IsList1, @Item2, @IsList2, @MaxItemCount))
					end IsInOrder
GO
create or alter function fn_AOC_2022_Day13_CompareItems(@Item1 varchar(max), @Item2 varchar(max)) returns table
as
	return
		with rec as
			(select 1 Lvl, 0 ItemID, cast(0 as varchar(max)) Lineage, iif(it1.ItemType & it2.ItemType > 0, 1, 0) IsComparable,
					iif(it1.ItemCount > it2.ItemCount, it1.ItemCount, it2.ItemCount) MaxItemCount,
					Item1, Item2, it1.ItemType ItemType1, it2.ItemType ItemType2, it1.IsList IsList1, it2.IsList IsList2
				from (select @Item1 Item1, @Item2 Item2) i
					cross apply fn_AOC_2022_Day13_GetItemInfo(Item1) it1
					cross apply fn_AOC_2022_Day13_GetItemInfo(Item2) it2
			union all
			select r.Lvl + 1 Lvl
				, NewItemID ItemID
				, cast(concat(r.Lineage, '\', NewItemID) as varchar(max)) Lineage
				, iif(it1.ItemType & it2.ItemType > 0, 1, 0) IsComparable
				, iif(it1.ItemCount > it2.ItemCount, it1.ItemCount, it2.ItemCount) MaxItemCount
				, it.Item1
				, it.Item2
				, it1.ItemType ItemType1, it2.ItemType ItemType2, it1.IsList IsList1, it2.IsList IsList2
			from rec r
				inner join Numbers on Num <= MaxItemCount
				cross apply (select Num - 1 NewItemID) n
				outer apply (select [key], [value]
								from openjson(Item1, '$')
								where r.IsList1 = 1
									and [key] = NewItemID
							) p1
				outer apply (select [key], [value]
								from openjson(Item2, '$')
								where r.IsList2 = 1
									and [key] = NewItemID
							) p2
				outer apply (select case when r.IsList1 = 1
												then cast(p1.[value] as varchar(max))
											when r.IsList2 = 1 and p2.[key] > 0
												then null
											else r.Item1
										end Item1
								, case when r.IsList2 = 1
												then cast(p2.[value] as varchar(max))
											when r.IsList1 = 1 and p1.[key] > 0
												then null
											else r.Item2
										end Item2
							) it
				outer apply fn_AOC_2022_Day13_GetItemInfo(it.Item1) it1
				outer apply fn_AOC_2022_Day13_GetItemInfo(it.Item2) it2
			where r.IsComparable = 0
			)
			, i as
			(select row_number() over(order by Lineage) ItemID, IsInOrder
				from rec
					cross apply fn_AOC_2022_Day13_GetIsInOrder(Item1, IsList1, Item2, IsList2, MaxItemCount)
				where IsComparable = 1
			)
			, i1 as
			(select min(iif(IsInOrder = 1, ItemID, null)) FirstItemIDInOrder
					, min(iif(IsInOrder = -1, ItemID, null)) FirstItemIDOutOfOrder
				from i
			)
		select i2.IsInOrder
		from i1
			cross apply fn_AOC_2022_Day13_DecideInOrder(FirstItemIDInOrder, FirstItemIDOutOfOrder) i2
GO
declare @Str varchar(max) =
'[[[],[3,[],4,[2,1,3]],8,7],[0,7,[[5,2,1,0],5],9],[10,[[],4,[7,2],2,8],[[2,1,0,5]],[[7,2],0,[],[3,5,1],5]],[0,10,2]]
[[],[3,[[6,3],[2],[8,3]],[[1,6],[3,9,1],[]]]]

[[3,2,4],[1,[2,3,[5,1,8],7,9]],[[4,[]]]]
[[[[],[],6],3]]

[[[[],[6,7,8,0,5],1,8,3],7,4],[[9,10,2,9,5],5],[10,[3],[[],[9],1,3]]]
[[7,[0,[1,2,7,0],3,[10,4,10]],[[10,1,8,5],5,0,[3,8,4,0],[4,9]],9,7],[[[9,2,3,9,0],5,[8]]],[[7,[7,9],[4],[0,4,5,2,10],[0,6,3,0]]],[5,[],[9]],[10,3,8]]

[[[[7,7],[],10,[0,8]]],[7,[[],2]],[3,10,[[1,0,10,7],[6,10,5,2],[8],5],[[]]]]
[[[],[[4],9],9,[[3,1,7,9,3],[2,5,4,3,9],[7,5],[],[4,0,1,2,4]]],[[2,6],9,2],[],[[5,2,4],3,[2,9,9]]]

[[[5],[[0],[0,7,0,6,5],[2],[4,3,5,8]],1]]
[[8]]

[[[]],[[7],2,6],[[1,10],10],[[],[],[[10,2,4,7,9],0,[2,7]],8,1]]
[[2],[4,9,3,7]]

[[[[3],[],[],[1,0,4,0,2],0],[10],4,[10,[7,3,4],0,[10,5,6,2],0],7],[6,[4,5,[2],1]]]
[[],[9],[[0,[],0,[6,3,1,0],[9]],[3,[10,9,5],3]],[]]

[[[4,9,[1],0,8],[[0,1,10,2,0],10,[6,3,3,9,4],[],4],4],[2,7],[[[6,10],[1,6,8,1],[4,1,5]],3,[2],[[5],8],7]]
[[4],[[[6],[],2,9,[8,6,1]],10],[2,[2,[5,6,2,0,7],[8,3,9,2],0,[1]]]]

[[],[[[2,7,3,4,5],3,[0,8,5,5],[3],[6,2,3]]],[[[],[10,0],[2,0,0,5],[4,4,9,1],[9,4]],7]]
[[5,1],[10],[[[4,6,7],10,[8,0,10,6]],[]],[2],[[[1,10,0,9],9,[10,0,7,10,10]],[4]]]

[[2],[7,[],[3,[],5,[4]],9],[[],6,[8,[4,8,3]]],[5,10,[[6,7,10,2,6],10,0,[8,2],[1,7,9,3,8]]],[0,5,10,3]]
[[9,[],[],[0],[1]],[[],[[1,0,4,10],7,[8,4,5]],5],[[],[[4,0,7,2,4]]],[[[8],10,1,2,[]]]]

[[[],[],[3]],[4,5,7,1,[[9,6,1],5]]]
[[0,[[3]]],[[[5,2,0,9,0],6,[]],2,0,[[8,7,2],0,[0,2,1,1]]]]

[[3,[[]],[3,5],[[0,10,10],[]],5],[[10,2,6,1,5],6],[]]
[[[[4,5,6],5,2,3],[[2],[9,6,8,4,8],[5,8,6,3,2],8],9,[6]],[[2,[7,9,0,9]],[8,[10,4,8],6,[7,10],3],[[1,0,5,1,8],6]],[9,4],[[5,10,[3,9,2]],[],7,[],5],[2,6]]

[[5,9],[5,[],[0,1,[0,7,7],[10,3]],8]]
[[[],[[10,5,2],[]],[10,[6,6]],[1,[1,3,3],[2],6]],[8,1,[3,7,[8,8,1]],[[8,10,10,3],0]],[[[4,6,9],0,[],7,[9]],9,[[6,4],[5],5,2,[2,5,10,1,9]],5,[[2,3,10,7],[9,6,10],[2],[3,4,3],8]],[[2,7,5,3],6,[10,[10,7],9,9],4,2]]

[4,3,8,9,8]
[4,3,8,9]

[[2,6,1,7],[4,[],3,9,4]]
[[],[[9],[[3,0,7,10],7],[8,3]],[0,[[7,10,8,9,5],[7,6],[6,8,9,10,2],[7]],0,[[4]],[1,4,4]],[],[[9,2,[1,9,9,3],[9]],3,3]]

[[[3,6,[],5,10],6,8,[0,[1,7],6,5,6]],[]]
[[3,9,8,9],[7,[0,[1,7,9,6,5],0,[6,5,2,1,5],1],[[4,2,8],10,[4,8]],[[10,10],9,[5,4],5,1],8],[],[10,[]]]

[[7,10,[6,5,0]],[[7,2],[[7,0],4,7,[]],[[9],5,[10,0,6,10,10]],[6],1],[[[3],[]],1]]
[[[],[[0,7,9,6,10],[4],2,8],[7],3],[[[],8,5,[9,6,8,9,7]]],[4,10,[7],1,5],[],[0,7,[4],[7,[9,3],6,7]]]

[[[0,0,10,3,0],[[10,6,10,9],[],6,2],2,[],3],[[],4,[4,4],[10,10,[6,3],3,8],7],[[[],1,3,[]],[9,3,[8,6,8,7,5],2]]]
[[[8,10,4]]]

[[[[10,8,7],[7],0,2,4],8,8,6,[[0,3,3,2,3]]],[2,[6,[0]],[[]],8,[[],8,[5,0,1],[6,6,6,10],[2,0,10,1]]],[9,4,4,[],[[10,1],[5,8,1,5,8],8,10]],[[1,2,[8,1],6,6],[3,8,7,[4,4,10],10],[],9,[4,5,[3]]],[3]]
[[],[[[7,0,2],[],[6,1,8,4],[10],[]],10,8],[[[7,7],1,4,[8,2,1,4],4],[1,[2],10],9,1,4]]

[[10,[0,7,[],3,[1,6]],[[2,4,5,4]],[]],[],[6,6,[[2,6,7],7,[5],[8,4,10,4,8],[0]],[10],[]],[[[],[6,0,9,10,2],8,[0]]]]
[[[6]],[[3],[[]],[[0,6,8,9,5],[7,9,10,2]]],[],[[[1],[9],5],9,[[],[0],5,1,[5,0]],5]]

[[[6,[0],[2,7,4]],8,1,[]]]
[[4],[[[5],[10,2,1,8,9],5,[4,0,2,9,9]],0,[8,[7,2,0,1,0],[0,6],8,[7,2]],8]]

[]
[[[[4,4],[5],[8]],8,8],[10,[[7,7,5,0],9,4],[],[6,4]]]

[[[4,[]],[[9,8,2,2,3]],2,[]]]
[[],[2,1,[[3,7,4],4,[2],2,[]]],[7],[[0,[7,2,6],[2,5],1,[8,4,10]],[[6,6,8,1],7,[],1,0],[10],10,[0,[9],6]]]

[[6,7,[5,[8,4,6]],10,10],[7],[8,[[8,8,6,10,6],[5,8,4]],[1]],[4,2,[1,[0,3,1,7],[9,1,4,2],[],[4,6,4]],4],[[0,4,2,[10,1,1,9],[8,5]]]]
[[],[[[],10,9,[10,8,5,3],[9,7]],3],[[3,10,6],[4],10,10,7],[1,[10,[1,2,9,8],0,10],[[4,9,6,10]],2],[0]]

[[],[[],[[8,5,5,8,5],[4,9,1,10,7],[1,5,7],[10,6,5,6],2],[[1,5,6,7,10],[6],4],[[4,3,5],2,7,6,[4,0]],5],[[2,8,6,[8,10],[1,10,10]],[3,[8,9,6,8],8,[0,0,7,9]],[[9,5,6,0],[2],[8,6,4,6,6],[]]],[2,[[]],[[],8],4]]
[[5,8,[0,9,0,7,[0,8]],[7,[7,7],[9,4,7,6,7],[8,0]],[[5],[10,1,2,5,4],[],[1,2]]],[8,7],[3,[[2],8,0,5],9,[]],[8,0,4,5],[[]]]

[[[3,1,[5,5,2,3,1]],[[],[1,1,3,1,0],3,[10,9,4]],0,7],[[[2,2,4,1,10],[],9,2,[6]],7,[[2],3,[4,5,0,3]]]]
[[],[2],[]]

[[10,[4],[3,[5],1],3,6],[[7],[[6]],[[2,0,2],[],[0,5],[4,7,2]],1,10],[[],[5,0,0],5,7],[6,[[9,2,0]],[]]]
[[[6,3,[8]],0,2,1,[3,[3,10,10],[7,3,3,6]]],[[[6,1,9,10],[6,6,4,5,9],[9,0,2,2,3],7,1],2,[]],[],[],[[2,[10,9,5,10,1],9,9],[3,6,5,7],10]]

[[[6,[3],[8,6]],7,[7,[2],6,[6,6,1,0,6]],4],[],[[[5,0,3,5],1,1,[9,4,10,5,1],[1,9,5,3,8]],[[10,1,2,8]]],[8,[],[[3,2,0,2],10],1],[]]
[[[7,[],9,3],[1,[10,7,0,2],1],8,3],[10,7,[4,10,9,[2]]]]

[[7,7,1]]
[[6,[5,[8],7,9,[9,3,2]],[9,10]],[[1,5,[5,6,8,7]],[]],[],[[7,6,7],7,[]],[[[8,2,9],[10,9,3,6],[0,1,2,4,1],4,[4]]]]

[[0],[[9,3,3],5],[[[4,0,2,8,3],10,1]]]
[[[[10],[8]],1],[1],[5,[[10,2,6,9],[0,10,9],0]]]

[[4],[[8,5,10,[8,8,7]],4,[],[7],9]]
[[[[7,6,0,5,6],[],[],[3],8],[3]]]

[[[3]],[3,[4,[4,10,5,0],7,2,[8,5,6]],[4,[1,3,10,2],[9,8,3,10,6],[2],2],[],[[0,4],2,1]],[7,[],[[3],[10,10,1],5],[[],[5,2,1,8,8],[7,0,6]],[6,[3,1,2,6],2]],[],[[[2,9,6],[1],[3],[]],6,[[9],[1,3,0,4],[2,9,10,6,3]],3,1]]
[[[[],6],[],[[4]],[]],[1,7]]

[[[],[[3]],[],8]]
[[4,[7,4,[0,1],2],5,2],[[],[7,2,[6,5,1],4,[1,2,10,5]]],[[0,[2],1,[]],9]]

[[[2],[[9,5,9,10,1],1],[],[3,[]],7],[],[1],[]]
[[0,7,[[0,6],[6,6,0,4],[10,4,6],[9,3,3,2,10],7],5,4],[],[[[7,9]],[8],[7,[],[3,3,2,7]]],[[],4,3]]

[[],[],[3,1],[10,5,1,3],[[4,9,3,[7,7,8],[9,4,2]],3,[4,0,8,[]]]]
[[7,[[8,2,4],7,[10,9],[]]],[[],[[1,3],5,[6,7],[6],10],9],[],[[],5,4,[[1,8,6,3,3],1,4,6,8]]]

[[3,[]]]
[[[6,[],[]],[6],[9,[1,6],7],[[5,6,5],[5,3,2,8,8]],[4,0,[]]],[[],[2,[6,3,9],2,4],6],[3,[],[4,4,[1,6,2,2,2],[7,10,1,9],[9,10,4,2]]],[[[5],[9,7],[],3]]]

[[[1,7,[10,8,8,4,2]]],[5,[[5,3,8]]],[0,6,10],[[2],2],[[],2,0]]
[[[[],[0,5],[4,2],0],4,8,0,3],[[2]]]

[[[],[]],[7,6,7,[0,4,5,[9,2,7,4,7]],7],[0,0],[]]
[[[9,0,[0,2]],[[7,10,1,0],5],4],[[3,[4,1,5,3]],7],[[[8,0,10],4,[10,3],[1,0,10,3,1],5],5,[7,9,[10,8],8,6],[5]],[[[6,0,9,0,7],4],8,[],[9,[2],6,1],1]]

[[],[],[10,3,[6,[3,3],[6],[0]]]]
[[8,6,4],[[3,[10,5,0,2],[2,9,6]],4],[2,0,[[7,0,5,6,0],10,8,3],[0,10,1,[3,7]],9]]

[[2,[6,[],8]],[[5,3,[]],[10,7,[0,0,0],[3,10],1],[[1,3,5,4],[2,10,2,7],0,6]],[[10,[4,9,6]],7,6,[]],[[10],[8,[],4],[[8,1,5,0,4],2,3],[1]],[5,5,[]]]
[[[],[[7,4,4]],0],[3],[[[8],0,1,7],[[8,6,0],8,[6,4,0],[9,4],3],5],[2,9,[],1,[[0,6,8,1],10,[]]]]

[[],[[[]]],[[],1,[10,0],[[],10,[]],5]]
[[10,9,[[],7,[],2,[1,1]],[],[[9,3,3,9]]],[],[],[3,9,[]]]

[[[9,[6,7]],[[5,6,4,2],0,3,0,6]]]
[[8,2,0],[9,5,10,0],[[9,5,[5]],9,2,[[9,5],10,8,[9,2,8,9,9],[]],5],[5,8,[8,5]],[[[8,9,6,9],[0,4,7,9,9]],[5,[10],4,10],[2,1],7,[4,7,[7,6],10,[4,5,9,0,7]]]]

[[[[],3],6,[[9],[3,7,3,1],[5],[6,6,4]],9,0],[1,0,[9,7],2,[[],[0,1,1],2,[],2]],[[3,3,[10]],[[7,2,5,9,7],[1,0,7],4,8],3,7,10],[[[9,1,4,1,5],0],4,9,[6,0],[]]]
[[0,[5],2,[1,[1,9,4,10,9],1,[10,4,8],[10,3]]]]

[[3,6,4,[6,[1,3,7,9,5]]],[[[]],[],[[]]]]
[[[5,[3,10,1,2,5]]],[4,[4],2,[4]]]

[[3,[],8]]
[[],[[[10,0,8,8,10],[3]],0,[[0,7,6],[8,7,0,9,4],10]]]

[[[8,5,[],6],9,[9,5,9,[]],6,[]]]
[[4,10,[],6,10],[[5,3,[3,7,10,3,5]],[9,0],3]]

[[[[9,2,5,7,8],6,2,1,[]],[[2,6,7,4],[]],[3,8,[8,2,0,2],[6,6,10,4],[2,4,0,3,8]],8,[4,[0],[7,3]]],[[0,[4],[10,6,10,8,8],[3,10],[1]],[],[8,[6,4,9],[],2,[10,6,0,8]],6,[3,3,5,[5,5,5,1]]],[],[[9,[0,3,10]],[7,8],0]]
[[0,3],[[[3,3,4,2,2]],[],4],[[7,[5,5,2,3,10],8],9,3,[]]]

[[1,8,4,[9],[4,[9,0,9],3]]]
[[6,3,[[0,2,4,7],0,[1,8,0]],0],[[[],[7,9],[7],[9,5],[8,4]],[4,[3,10,4,6,0],9]],[[[8]],[],[]]]

[[[6,[3],[8,2,6,6,6],3,[7]],[10,[6,7,3,3],9,7,6]],[[10,2,10,9,[8,2]],[],[6,[1],10]],[[],3,7]]
[[[8,3,[4,7,1,0,1],[9,4,1,6],9],[9,8,[0,1,7,4,2]],[2,9,[8,2]],8,[[8,8,2,0],[]]]]

[[8,[],[[5,3,0,0],[9,8],7],0]]
[[1,1,[[],[5,10,0,2,7],[4,6,1,7,4]],5,7],[[[]],1,6],[[[],10,[10,5,8,5,3],[7,1],1],[9],10,[[7,7,3],10,8,[0,3,4]]],[7,10],[5]]

[[[2,1],7,4,[7,7,5,6,[10,1,2,9,8]],[1,[],[9,1,6,5,4],[2,5,2,6]]],[1,[[],[4],[0],0],9,[[1],[5,10,3],[2]],[]],[5,[[1,3,8,1]]],[2,1,4],[[4,[],4,3,[3,10]],8]]
[[],[9],[1],[10]]

[[[1,[10,6]],2,3,10],[5,[9,10,6,9],7],[[[],[10],[1,1,9,9,3],7],7,[5,10,1],6],[]]
[[],[9,8],[6,10,8]]

[[[[1,6,7,6],[7,5]],[[],8,0,1,[9,4,2]],[10,[9,6,1,3,6],5],0,8]]
[[3,5,[[],[9,2,8,5],1,[]],0,[]],[9,[[10,6,2,6,7],[],[10],3,[10,0]]],[7],[6,0,7,[]]]

[[7,[4,3,6],10,[7,3,[2,3,2,6],[5,6,1,2,4],6],[[7,0,3]]],[[[6,3,10,6,6],[2,6,3],[0,0]],[[]]],[],[]]
[[5,[[7,7,1,3],[],2],[[0,8,6,6,2],[0,7],0],2]]

[[6,9]]
[[[3,3,[5,3,5]],2]]

[[3,[[5]]],[[[],[0,4,6,3]],[4,2,7,[3,4,8]],1],[[[],[7,4],[9],7,4],7,3],[],[2,5,[[0,8],[3,6],10],1,[]]]
[[7,[[1,0,9],[8,8,9,2,9],3]],[5,8,2,[9,[10,3,7,6]]],[0,[[1,4,8,1,9]],[8,6,[9,10,7,6],[9,8,6,10]],2,[6,4,[4,2,2,1,9]]],[10,[[6],10,[3,1,9],10],4]]

[[[],[4,[0,4,7,3],[2]]],[[6,[10,9],6,1]],[2],[8,[[],1],[4,[3,4],2,[8]],8,9],[2,[[],[2],[4],[6,5,3,1,6],2],[8]]]
[[4,7]]

[[3,[],[[10,10,10,0,6],[0,2,6,3],8,9],[[],[1,6],2,[9,5,7]],[4]],[[[9,6,5,7],0,[3,10]],4]]
[[[5,[],[],[1,9,0,4,0]],6,7],[[[],10,[],[9,2,4]]]]

[[[],6,[[]],1],[3,7,[5,2,[3],8],[[4,6,10,2,7],[1,4,10,3],[2,1,2,9]],[8]]]
[[],[6,8,[[4,5,2,4,1],[10]]],[[[1,4],[],[2,6,3,3,9],2]],[[2,1,2,[4,8,4,2]],[[],4]]]

[[6,10],[10],[[[0,5,5,7,2],0],[7,[0,6,5]],[[1,1,3,3,2],9]],[10,8],[[8],[[6,3],4],[[1,7,2],10]]]
[[5,8],[0,3,10],[0]]

[8,2,7,9]
[8,2,7,9,3]

[[[4]],[[[3,9,3]],[]]]
[[],[[2],2,[0,[2,5,9,8],4,8,7],9,9],[6],[0,[[3,3,1,8,8]],4,[1,1,[]]],[7]]

[[[[],6,5],[5,9,[2]],2,[[0,8,8,8],6,1,4,1]],[0],[3,4,0],[[[6],[],6,[5,1,4,1,9]]]]
[[9,3,10,4,[6,3,8,[6,5]]],[[]]]

[[],[],[[[7,5],[3,6,7],4,[0,6],[9,6]],[[6,5,7,6,6],[3,3],[8],[7,4,7,8],[10,1,5]],[[6,7],[3,9,7,7]],2,[[6],[10,0,0]]]]
[[[4,4,8,[9,8,9,8],0],5,[0,5,[2,10,5],[5,8],[7,0,0,6,3]]]]

[[],[10,[7,[6,5,4,7],0],[],[[],[1]]],[9,6,1,9,9],[[[8],[3,3,3,7]],[9],4],[8,4]]
[[],[[[2,9,3]]],[[],[[],[]],9,[[],[]],2],[7]]

[[9,[[],0,[],[6],6]],[4,[[5,3,10],8],10,[10,[10]]],[[5,[5,6],[0],7,8],1,[[1,3]],[[0,0,3,9,3],4]],[[4,[9,9],0],[4,[0,4,9,6,10],7,1],[[],4,10,[0,2,8,3]]],[[[10,8]]]]
[[[2,9,8,[4,7,9,8]],[[5,7,0,9,4],[],[7,5],6,6],6,[[5,3,1],7,[2,1,5,0,10],1,[1,8,5]],[]],[],[10,3,10],[[10,2,[0,5,4],[8,3,0],8],[4,[],3,[9,1,4,4]]],[9,6,6,[[10,7,0],[0,10,2,4,3],[9,7,7,9,10],[6,6,8,10,5],7]]]

[[3,8,[]],[8],[2,3,[5,2,[8,9],[5],[]],[[7,2],[8,2,6,4,5],[3,4],[2,3],5],8],[[6,7,2,2]],[[5,[4],[3,9,1,2],[7,9,7],[10,1,10]],[6,[4,3,5,1],3,[10,10,7,5,6],7]]]
[[3,[[2,2,0],8],[[3,4,4],10,10]],[8],[[[7],0,10,4,[3,8,5,9]]],[6,8,[],3,4]]

[[[[6]],9,[0,[],[5],[5,7,1,4]],9,[3,4,1,[2,10]]],[[5],[]]]
[[7,[3,[10],6,3]]]

[[5,[8],[7],2],[4,8,[[8],[5],[10,3,8],3,[4,3,1,0]]]]
[[6,0,[[]],5,6],[],[2,[[2,3,5,4],[6,6],7,4,1],[9,[2]]]]

[[],[[],[8,6,5,10],[2,[0,4,9,4,1],[10,1,0,2,1]]],[2,[],[[7],[10,5],[10,0,2]]]]
[[7,2,0,7,[10]],[]]

[[[8,[2,9,3],[10,9,10]]]]
[[[6,3,3,[3,6,1,4]]],[[],[[0,9,8],6,[],[4,1],0],[[],[7],[10,0,6,3,7],1,[3,3]],[8]]]

[[],[[2,6,7,6,[6,8,8]],10,0,1],[]]
[[[],[],7,[[10],9,[6,8,0,7],8,[2]]],[[],[9,9],9,[[2,6],4,3,5]],[[[3],[]],[[8,2],1]]]

[[[]]]
[[[5,4,0]],[[[1,7,9],[]],[3,3,1,7,3]],[0,[2,[],10,2],[[]],[7,2,[7,0,10,3,8]]],[1,[]],[[6,10,[5,8,5,0,9],[9,1],4],[4,[4,0,1,7]],8,8]]

[[[5,6,5,[0,7,6,4],9],8,[8],[[2,7,3],4,10,7,[5,10,10,10,1]]]]
[[6,1,[[1],[10,2,6],[7,4],[6,4,3,3,5],6],[0],9],[],[5,[[6,0,9,6,2],5,10,1,9],2,[[0,6,1,4,10],3,[]]],[[5,7,[7],[6],3],[[3,0],6,[1,10,3,10],4,4],7]]

[[],[[2,[5,2]]]]
[[6,1,5,[[3,7,2],[],[0,0]]],[6,8,1,9]]

[[[4,[],[4,5,6]],[],[2],[2,[8,1],5,[8,1],4]],[[6,[7,6,4,2,0]],[9,[7,3]],[],[9,[10,8,0],[],5]],[6,[8,[8,4,3,10]]]]
[[[0,[5,10,4,7,8],[3,0,6,7],10,4],10,5,7],[1,[],8,9]]

[[],[5,[7,2,9]],[7]]
[[1],[[],3,[[0,5,1],[9,6,9,10]],[7,8,10,9],[0]],[[5,[9],4,[0,9,4,0]],[],[[7,6],10,[8],6,1]]]

[[[7,5,2],[3],4,2],[[[10,9,2]],[[5,3,5,7],7,[6,0,0],0],[[6,10,1,5],[]],[0]],[[[8,5],[6,0,5],6,8,[4,8,10,5]],7,[[10],[],3,[]]],[],[[[8],1,[3,7,8]],[[9,7,7,8],[8,4],[6,5,3,9,10],[8]],[[7,4],[1,4,5,9]],[5],6]]
[[4,7,4,4],[2],[],[6,[[9,2,6,7],[8,4,9,9,0]],[5,7,[8,4],[8,6,9,3,8],[8,9,7]]],[]]

[[[[10,2],3,[],4],[[2],3,2,8],[8,[1],10]],[[[10,1,2,8]],[0,[10],[2,9,3,7]],[5],[1,1,7]],[[6,[9],[4],4,[6,8,5,4]]],[[4,[],[9,5,5],[1],[9,10]],[],[2]]]
[[],[[[7]],[[1,5,10,5],[10,2],6,[],[9]],1,[]],[],[[4,9,[4,2],[7,8],[5,9]],[6,8,4,5]]]

[[[1,3,[10,7,2,6],9]],[[2,5,[1,7,5,7],0,4],7,[5,[6,6],[]]],[[4,[2]],8,2],[[[5,1]],0]]
[[[],[[2,10,9,1],[8],[4],[1,6,8,1]]],[9,3],[7,[6,10,[10,0],[9,5,7],8],[[0,0,7,9,6],9],8],[0,0,[3]],[1,2,0]]

[[2,[[3,1,1],8,[6],[8]],[[1,0,6],[7,4,8]],4],[[],4,7,[6,9,[5,8]]]]
[[[]],[[3],10,[],0],[[[3,5,3,5,1],[9,7,8,9]],[[3,1,10,7,4],[],[9]],[[1,0,8,7],2]]]

[[10,[[1,2,4,8,8],3,1,4],6,[[8],[10,6,0]],[]],[[6],[9,[],3,4],[[10,4],5],9]]
[[[3,[10],4,[0,0,3,5,6],[0,1,10,3,6]],8,[],9],[]]

[[[5,9],2,[],[9,[],4]],[0,[9,[5],3]]]
[[],[2,[],8],[[0],[]],[[[3,5],[3]]],[[[6,8,0],[2,10,10],[7,0],5,[3,3]]]]

[[],[6,8,6,[0]],[]]
[[],[[[10],10,8]],[],[[],1,5,[[7,2,0,0],[],[]]]]

[[3],[10,10,6,0,0],[],[5,0,3]]
[[[[6,1]]],[9],[0],[[[9,4],8,3,7],2,4,[]]]

[[2,6,1,7],[[[1,9],4,1,[3,8,0,4],[2,6]],4,5]]
[[[10],[],0,[[3,5],6,4],[]]]

[[[[],10],0,[[3,0,7,1]],4,2],[[[2],[7],[1],[8,6,4,2,9]]]]
[[[],8,[]]]

[[],[],[0,[9,[6,8,2,2],[9,9,7,3,7]]],[[7,[3,4],4,[5,4,4,2],4]]]
[[[[9,7,1],10,0,6],[],[2,4,5,[7,5,2,6,1]],9,[3,[3,3,8,10],[7],[1,8,6,1,2]]],[0,7]]

[[[[]]]]
[[[[9,2,3,10,4],[],1,5,[2,7,3]],6],[6,2,[[],0,7,[]],[2],[[],[],[],[4,5,9,0],0]],[[0,0,0,3],0],[[[1,7,4],[3,6,10],[2,2],9]],[1,[[],2,10,6],[[7,5,0],[3,3,2],6],0,4]]

[[],[[1],2,[[10]],[4]],[8,[[],[],[7,2,2,10]],6],[]]
[[[0],2],[[[7],1]]]

[[[[3,7],[7,4],[9,5,10,10,3]],4,[7,10,6]]]
[[]]

[[[[4,0,1,7,1],8],[8],[]],[[[1]],9,7],[[0,6],1],[[9,[10,2]],[]]]
[[10]]

[[5,3,[]],[9,9,[[7,7],6,[3,7,6]],[10,[6],[9,3,6,8],10]]]
[[[[5,2,0],[2,0,5,6,5],[9,2,5],0]],[6,2,[[7,10],[],[8,8,4,7,6],[4,10,2],[0,8,1]],[[8]]],[[[7,3,3,9],[3,1],[3,6,2,8]],[[]],0,[[1,9,9],8],[1,4,[8,10,3,8,9],[5,3,2,8,2],6]]]

[[3,[5,5,[1,0,10],[0,2,8,8]],10,[]],[[[2,5],8,8,[2]]],[4],[6,3]]
[[],[6,[[3,3,1,0],1,[10,4],7,[3]],[0,1,[5,6],[]],10,1],[7,[1,2,6,[7,5],[1,3,3]]]]

[[[]],[[[3,5,0,9,9],[10],[3],9],5,[4],[3]],[],[[9,10],[[5,0,5,1],[0,8,2,5,8]],3,[[5,2,9,1]],[7,[],2]]]
[[5],[10,[[8]],0],[10,[]]]

[[0,[[],3,[10,10,8]],[[9,4,1,8],[6],[4]]],[8,[[3,3,5],5,[],2,10],[[10,3,1,4]],3,[1]]]
[[],[10,[9,[],[],[5,10,9,3],[5,10]]],[],[[7,2],[4,2,6],6,2]]

[[[1,[2,7,2],[2,7,2],[9,2,7,0,4]],[[7,4,8],[8,8,0],4,[2,4],7],[[4,0],5,[7,2],6,6],[8,4,[4,7,3,9,5],7]],[2],[7,[7,[3,4,10,2],3],10],[7,[],9,2],[5,2,6,10]]
[[5,[[],[4,4],1],[],[2,7],4]]

[[4],[0,[0,10,5,[9,8,1,0],2],5,4]]
[[[],1,[9,[0],[],[1]],[4,4,5,6,[4,4]]],[],[[[1],[]],1,[[9,10,4,1,7],10,[]],[],10]]

[[[[3,1],6,[],0],[[],[4,5,8],[8,0,0],8,[4,7,7]]],[],[9,1]]
[[[[10],[8,9,1],[9,10,1]],8],[[]],[]]

[[9],[[[0,5,6]]]]
[[[4,3,6],9,1,[[],5,[9,6,7]]],[2,[1,[4,4,0,9]]],[[[1,4,0,6,7]],8,3],[[[1,2],[4,6],[0,10,10,1],[],[7,2,2,9,5]],3,1]]

[[8,[[],[0,7,1],[],[4,7,1,10]],3,[0,[2],[],5,[6]]],[],[[5,[0,9,4,5],5],[[],[5,5,1,10],10,7],5,[[5,3,5,10,2],0]],[[[7,1,0,10]],[2,[],[0,3,8,1,1],[3,7,1,5]],8,[[5,9],3]],[[0,3,10,8,10],6,0,[]]]
[[[],2,2,6,0]]

[[],[0,[[5,2,7,7,2],[3,8,3]],7,9]]
[[],[[[1,0,3,6],[3,10],[9]]],[[3,[8,10,0,9],8,[7,2,4],0],[[4],[9,1,4,3],10,3,2],0,2,6],[3,[[4,6],[3,1,2,6,4],[],[7,10,6,8],6],[],3,[[]]]]

[[6,5],[[[1,10,10,9,6],4,[3,1,8,9],10],[[7],3],[[2],[2,4,5,5],[7,4,4],7,10],10,[[9,5,2,6,10],10,[6,10,10,9]]]]
[[],[4,[0,[6,6,4,9]],[[3,9],9,[4,10,9,9],6],10,4]]

[[9,[[1,4,2,7,4],[2,9,5,8,2]],[6]],[[[0,9,3],7,[]],[10,[2,3],7,[4],[1,5]]]]
[[[6,6,[7,0,9,0,3],9,1]],[9,[5],10,2],[[],10,[[10,4,6,4,2],3,1,[9,5,9],4]],[],[[10,9,[9,3,4]],[[2],[1,7,4,9,5],[],[8,7],8],[[9,0,9],5,2,[8,0],5],[]]]

[[[[10,1,10],8],[],[4,[5],[8,10,0]],[[0,10,4,6]]],[3,6,[8,2,6,2]]]
[[],[[],[8,[],10],7,0]]

[[2,0,8,[[9,4,8,5],10,[0,7],[9,0,1,5]],[3,7,6]],[[5,4,2]],[4,3]]
[[[],[[]]],[],[7,[],[],[[5],2,[6,1,6]],3],[9,[[0,9,10,8],[8,7,3]]],[10]]

[[8,3,[0,[0,1,2,3,3]]],[0,7]]
[[[],10,[10,6,5,10]],[[[2,4]],5],[[6],2,[[1,5,6,6,1]],[[9,2,2,10]]],[10,[[],[]]],[6,3,[[],2,[7,6,6,3],6],1,7]]

[[],[[[],[0,3],[8,6,8]],[9,2],[[0,10]],5],[[[9],[8,1,3,9],4,7]]]
[[10],[2,[[9,10,0,3,9],[4,5,9,1]]],[3,3,[0,9,6,4],8,[9]],[[[],[]],10,[[0,1,0],[8,3]]]]

[[4,[[4,1,0],[9,6,3],[],8,[]],[[10,6],[2,0,4,1],0,[8],2],5,10],[[9],6,[],[[10,2,3],[10,0,5],8,5]],[7]]
[[[9,[9,5,7,0]],[2,4,[4,1,2,4],[2,8]],[[6],1,[10],[1,4,7,2,10]],3,10],[[8],[8,[],2],[[9,9],6],[[]],6],[[6,[6,9],2,[3,9,10,2],[2,8,7,6]],[[7,6,9,9]],[],8],[2,[4,[1,4,2]],[]],[]]

[[10,0,10],[3,[7],2],[[[9,9,8,5,10],[1,1,5]],7],[[],[0,[9,2],0,10],[0,10,[4,8,7,6,6]]],[]]
[[[[8,7,1],2,[6,1,5,8]],[4,[9]]]]

[[9,4,[3,[7,8],[3],[10],2]],[8],[]]
[[[1,7,5,1],0]]

[[[2],2],[9,[7,[8,3,4],4],0],[1,[6,6,[7,9,9],[10,1,9],[5,10,9,7]],[[10],4],[[0,4],[10,10,10,1]],[0,1]],[[[9,1,8,0],[7,4,3],[8]],[],[[2,9,1,4,10],[4,9,3,9],9,2,2],3],[[3,[8,7]],[[]],[[8]],1]]
[[],[8,2],[[1,1,3],[[7,6,2,10],4],[],[2,4]],[[[],10,[2,2,2],7],[]],[6,5,0,7]]

[[[7,[0,9,6,0,9],[4,8,0,9]],[[3,9,7,8]],4,1],[4,1,[[],1],1,[4,[1,0]]],[],[[],[],9]]
[[[[4],[7,9,4,7,9]],9],[5],[[]]]

[[[[0,10],2,[5,2,10],5],[],[]],[[[5,2,10,8,9],[10,10,8,5,3]],2,[[],10,6,5]]]
[[[0,2,[]],[[]],10,6,[4,10,[9,1,5]]],[0,[],[]],[[[3,0,0],3,[9,0,2],5,8],8],[1,[[1,7,9,8],[0]],2],[[[4,6,0,3,0],[7,6],1,[5,9,1,6],1],7]]

[[],[3,[2,0,[3,5],[8,8,4],[8,3,7]],10,4,[[8,7,4],9]],[3,3],[[],[0,8,5,5],8,1]]
[[[5,6,[],[]],4,9,[[0,7,0,4,8],[3],9,[3,4,7,10],1]]]

[[],[10,4,[7,[6,4,7],5,10,6],[[6,7,1,0,1],9]],[5,9,[[8,2],[5],[2],0,[]]]]
[[9,[2,2]],[],[9,9,[[],5],[[]],[]],[],[]]

[[5,3],[[],4],[[[6],5,5,9],[1,7,4,[2,5,1,10,5],2],6]]
[[],[2,[[0,9],9,7],[6,[8,7,3,4]],[],[7,1,[0]]]]

[[],[4,[[2,7,3],[4,9,7,3],3]]]
[[],[[],7,0,8],[[10,[2,10,0,2,4],[9,9,9,5]],9],[[[6,2,10],[9],[2],3],[],6]]

[[],[[10],6],[],[],[7,8]]
[[[5,1]]]

[[[0,1,[4,10]]],[9,[]],[],[4,6,4]]
[[1,3,3,[7],2],[[[9,2,8,0,6],[9,2,10]],[[9,5],[6,6],10,[2,9,5,6,0],[7,0,8,4,3]],[[2]]],[1,0,[10,[],[7,1],3],4]]

[[[8,0]],[0],[[7,[2,3],[0,1,4,1],10],9]]
[[[[0,3,0],10,4,[0,10],[7]],[0,4,[8,10,7,10,10],[],3],[[6,2,5],[],7],6,1],[[],6,6,[[3,5,3,8,0]]],[[0],4,[],[]],[6,8,8,[0,[4,9,2,7,4],[2,1,3,0,5]]]]

[[[[7,5,6,2,8],4,[2],7,[2]],10,4,0,[]],[[[3,7,6,10,4],0,[10,9,7,1]],[3,[],[4],0],[3,[2,3],[1,6,10,2],2]],[],[],[6,[6,8,[7,5,1,6],[1,5,2],[9,1,9,2]],[[10,1,6],[6,0,4,4],9,0,[2,1,10,0,9]]]]
[[3,[2,[1,5],[3]],[],[[2,6,10],5,[8,5,7,4],[8,9,6,6],1]]]

[[0,[[4],1,4],[[9,0,7,1],[4],[0,2,2,3,2],2,4]],[9,10]]
[[0,[2,8,[2,9,3],3,[]],[10],4],[[6,[6,7,7],9,5],[[9]],[2,[0,8,1],[3,6,1]],[[2,6,0],8,[6,2],[0,10,5,8,1]],9]]

[[9,3,6,[[1],[10,1]],6],[]]
[[0,3,[4,[],[10,0,1,6],10,[6,3,2,8]],[[3,0],[2,8,5,10]]],[[],7,3],[3],[10,[3]],[4,5,8,[[],[4,3,8],4,5,7],10]]

[[5],[9,[3,[1,9,8,4,8],0,7,[4,2,2]]],[],[[[2],3],5,6,[[5],1,2,[9],[8,6]],1],[6,8]]
[[],[],[0,[[4,8,9,3],[2,1,7]],8],[[],10,4,[[]]]]

[[[8,8,6,[]]],[[[5,3,8],5],[0]]]
[[[1,[10,9,7]],9],[],[[10,6]],[[6],[6,[]],[[],1,8,3,[10]],7],[4,10,[[7],[]]]]

[[],[[],2,4,[8,7,[8,2,7,1,9],9,[1,1,10]],8],[[],1]]
[[[[3],[5,10],[1,10,0,3,7],[8,9,1,2,5]],5,[0,[4,0,5,5,10]],[2,[1],6],[]],[0,3],[],[[[9,7,2,10],[8],0,[10,9,3],2],6,[8,0,[6,10,2,4,4]]]]

[[[4,[6]],1,9,[]],[4,2,[[6,1,9,9],[6,3,1,7,8]]]]
[[[6,[4,0,1,2,4],2,[7,4]],[[5,4],0]],[7],[[9,8,[10],[5,9,3,5,0]],[[10],[7,2],[3]],8]]

[[1,7,[[8,7,5],1,2]],[0,10],[[[3,10]],[],[6,[7,9,7,3],6,[4,6],10]],[]]
[[[1],2],[],[],[0,[3,[5,4,1,9,2],[8,10,4,5]],8]]

[[[[5,8,2],7,10,5],9,[[],[7]],[[4,3,1],[7,2,2,6,10],0]],[[[10,0],4],[[],[5,1,4,9,4],4,7,6],[8,[7],3,[10]],2,[[1,7,7]]]]
[[],[[[],1],10,[10,[3,4,9,5],[1,8,7,0],0]],[[[6,4]]],[]]

[[[],10,9,0,8]]
[[[10,[]],[5,7,[6,8,5],6,6],[9,1,5,1],[[],10]],[9,[6,[7],[10,0,4],[1,7]],8,[]],[[3],2,1,[[5,0,8],4,3,[4,0,0],[3,1,0,10]]],[[5,[],[],[7,10]],[4,[5],10,[5]],4,[[7,8,1],0,[4,7,3,7],[5],[10]],6]]

[[5,5,8,2,1],[3]]
[[[[1,6,1],[4,4],6,6,[8,0,2]]],[],[],[]]

[[[4,7],2],[5,[10,[1,7],6,[10],7],[2,10]],[3,3]]
[[9,10,[[],1,9,5,8]],[[[6,8],[6,6,9,6],2,[2,4]],[7,[10,0,5]]],[1,[8,[8,8],[8,1,10,10]],4],[[[3,4,10],[5,6,3],0,[1,8,0,2,1]],2,2],[[7,[7,7,2],[5,8,6,6,9],[9,9,6,3]],[8,[],6,[5,9,5]],0,[3,4]]]

[[4,[[10,2,2,2,1],8,[0,10,7,1],0,[7,5]]],[[[7,7,9,10,9],[5,3,0],[8,5]],[[8,8,9],9,3]],[6,[8],10,[8]],[[[],4]]]
[[10,[[0,2,5,6]]],[0,[],6,[3,[1,7,6,4],[9,4],6],2],[[[9,7,4,3],9,7,10],2,2,[0,10,[9]]],[6,[4,[8,0,9],4]]]

[[6,10],[[[]],10,[6,7],[2,[]]],[0,7,[],8],[9,[]]]
[[[]],[],[]]

[[],[3,[3,4,[3,5,6,2,8],[]],[[3,0,5,6,5],[9,8,7],3],4,3],[6,[[2],3]],[[[2],[4,7],7],8,7,[],[[7,9]]],[[]]]
[[2,2,7,8,6],[[],10,[[2,4,2,4],[4,9,5]],5],[[9],[[6,1],[1,6]],2,[7,4,0,[1]]],[[[9,10,8],[2,6,6],[7,5,7],10,[5,7,1,3,9]],[1,8]],[[1,6],7,0,[[9],[4,9]]]]

[[3,[[0,10,1],[4,4,0],2,1,[7,3,5,2,6]]],[[[6,6,4],[],4,[2,2,2,7,3]]]]
[[[[0,6,9,2],8,[10,1]],8,1,[[1,9,5]]],[4,7],[4,[[]],[[1,5],9],0]]

[[2],[[[3,7,2,4],[6,9],[8,9],8],[]],[[],6,[[5],[5,1,9,4,10],[8],[0,0,7,3],[7]],[7,[2,4,7,8,6],5,3,0]],[[1,6,9,[0]],2]]
[[2,5],[],[]]

[[[8,[6,10,9,5],2,[4,9],[8,4,8,1]],4],[5,[5,3,[0,2,5],[],8],[[3,4,0,3,10],1,[],[]]]]
[[],[9,[10]],[2],[[4,9,[1,9,4],2],6,[[],0],[[1]]],[[3,[6],[],6]]]

[[],[0,[[3,0],1],[]],[10,0,[7,9,[9,3,9],4,[6,3]],3,2]]
[[[0]],[[[10,1,10,7,7],4,6],[5,[9,3,0,5],[1]],[10]],[[1,[7,1,9,8,7],[5,2,0],1],1,5,[[1],[0,8,2,5,9],1,2,10]],[],[8]]

[[[[0,4,0],[2,7,8,3],[2,8,4,3,2],[4,9,6,6]]],[0,[],3],[[[0,1],[9,0,6,8],9,[4,6,7,3,5],[8,0,9,3]],4]]
[[1,[2,7,3,8]],[]]

[[1,[5,[],0]],[[6,[9,5,6],[],[9,7],8],1,[],9,[[5],5,3,5]],[[1,[10],[6,10,2],6]]]
[[[[1,8,8],[10],7],[],10,0,[]],[[9]],[]]

[[[[10,1,8,9,1],7,4,9],[[4,9,6],[6,8,1,4]]],[[5,4],[],1,[[3],[],[],3],[0,[2,5,10,6,3]]]]
[[5,[[1,5,8,4,6],[9,4,6,8,2]],9,6,9],[0,0,[[4],[7,4,3,0],[10]],[7]]]

[[],[2],[6,[[]]],[2,[[10,8]],[3,[10,10],[3,2,2,10],2,[6,7,5]],6]]
[[0,5,[1,[0],9],[[5,7,6,8],[4,4,7],[],4,[10]],7]]

[[[7,1,1,1,0],[[1],4,7],[[8,7,4,5,6],6,[5,7],7],2,0],[5,10,[4]],[6,8,9]]
[[0,[],4],[[5,[10,10,7],9,5],3,[[],2,4,2],9],[10,1,[4,1,[],[5,3,1,10]]],[7,[0,[0,10,1],5,[2,8,4,9,7],[]]]]

[[0],[]]
[[6],[3,7,10,[7,[3,3,8],7,[],8]],[]]

[[6,2,8,1,[[],4]],[2,[[0],[10,2,7],[4,3],[0,3,7,10,1]]],[[[2,1,7,8,0],9,6,0,[2,10,4,1,10]],9],[6,1,10,10],[]]
[[[],10,[1,9,[4,0,1,1]],9,5],[2,[2,[9,4],[7,0,6,2,8]]],[5,2,[[0,3,4]]],[[]]]

[[3,[4,[]],6,8],[],[4,5,8,[4,3]]]
[[[7],[[0,7,5,2,9],9,6,1],[],[[1,10,1,6,9],5,2]],[10,[[7,8,10]],3,0,2],[[2,5,1],[[0,8,0,2],9,4,[10],[]]]]

[[],[[9],10],[[[4,7],[4,6,2,3],9,[2],[0,8]],[2,3],10,9],[4,6,[[1,3,7,8]],10,[[]]]]
[[[2],0,5],[],[]]

[[[1],9,5,9]]
[[],[5,10,[[8],[8,7,0,8,5],10,2,[0,6,9]],[[3,10,6],8],[0]],[]]'

drop table if exists #Input


;with i
	as (select i.ID - rn + 1 PairID, row_number() over(partition by i.ID - rn order by i.ID) ListID, Val List
		from (select row_number() over(order by (select 1)) ID, [value] Val
				from string_split(replace(@Str, char(10), ''), char(13))
				) i
			inner join (select ID, row_number() over(order by ID) rn
							from (select row_number() over(order by (select 1)) ID, [value]
									from string_split(replace(@Str, char(10), ''), char(13))) i1
							where [value] <> ''
						) i1 on i1.ID = i.ID
		)
	, i1 as
	(select PairID, List Item1, lead(List) over(partition by PairID order by ListID) Item2
		from i
	)
select PairID, Item1, Item2
into #Input
from i1
where Item2 is not null

select sum(PairID) Answer1
from #Input
	cross apply fn_AOC_2022_Day13_CompareItems(Item1, Item2)
where IsInOrder = 1

;with Packets as
	(select Item1 Item
		from #Input
		union all
		select Item2
		from #Input
		union all
		select Divider
		from (values('[[2]]'),
					('[[6]]')) v(Divider)
	)
select min(ItemID)*max(ItemID) Answer2
from (values('[[2]]'),
			('[[6]]')) v(Divider)
	cross apply (select count(*) + 1 ItemID
					from Packets p1
						cross apply fn_AOC_2022_Day13_CompareItems(Divider, p1.Item)
					where IsInOrder = -1
					) c

drop table if exists Numbers
drop function if exists fn_AOC_2022_Day13_GetItemInfo
drop function if exists fn_AOC_2022_Day13_GetIsInOrder
drop function if exists fn_AOC_2022_Day13_CompareLists
drop function if exists fn_AOC_2022_Day13_MakeList
drop function if exists fn_AOC_2022_Day13_CompareValues